using UnityEngine;
using Unity.Entities;

namespace Framework.UnityAuthoring.Authoring
{
    public class DamageableAuthoring : MonoBehaviour
#if !UNITY_2022_2_OR_NEWER
        , IConvertGameObjectToEntity
#endif
    {
        public int Armor = 0;
        [Range(0f, 0.95f)] public float ResistPercent = 0f;

#if UNITY_2022_2_OR_NEWER
        class Baker : Unity.Entities.Baker<DamageableAuthoring>
        {
            public override void Bake(DamageableAuthoring a)
            {
                var entity = GetEntity(TransformUsageFlags.Dynamic);
                AddComponent(entity, new Framework.Damage.Components.Damageable
                {
                    Armor = a.Armor,
                    ResistPercent = a.ResistPercent
                });
            }
        }
#else
        public void Convert(Entity entity, EntityManager dstManager, GameObjectConversionSystem conversionSystem)
        {
            dstManager.AddComponentData(entity, new Framework.Damage.Components.Damageable
            {
                Armor = Armor,
                ResistPercent = ResistPercent
            });
        }
#endif
    }
}

